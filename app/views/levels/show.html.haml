- content_for :custom_css do
  = stylesheet_link_tag "table.css"
  = stylesheet_link_tag "table-#{@level.grid_size}.css"
- content_for :custom_js do
  = javascript_include_tag "jquery.transform-0.9.3.min.js"
  = javascript_include_tag "gravity.js"
%div#wrapper
  %div#nav
    %p#counter-clock-wise.rotate &nbsp;
    %p#clock-wise.rotate &nbsp;
    %p#cancel-level= link_to image_tag('/imgs/shared/cancel.png'), root_path
    %p#reload-level= link_to image_tag('/imgs/shared/reload.png'), "/level/#{@level.id}"
  %div#board-wrapper
    %div#board.game-board
      %table{:id => "squares", :class => "board-grid", :cell_border => "1"}
        - @level.grid_size.times do |i|
          %tr
            - @level.grid_size.times do |j|
              %td{:class => 'square', :id => "row-#{i+1}-square-#{j+1}", :_cell => "#{i+1},#{j+1}"}
      %div#game-pieces
        - @level.game_pieces.each do |game_piece|
          %div{game_piece.class_hash, game_piece.attributes_hash}
  %div#level-info
    %h3= "Level #{@level.id}"
    %div#user-current-stats
      %h4 Current Attempt
      %table
        %tr#current-rotations
          %td.stat-title Rotations
          %td.stat-value 0
        %tr#current-locks
          %td.stat-title Locks
          %td.stat-value
            %span 0
            = " / #{@level.total_lockable}"
        %tr#current-coins
          %td.stat-title Coins
          %td.stat-value 0
    %div#user-level-stats
      %h4 Your Best Score
      - if current_user.completed_levels.include? @level
        %p.top-score= current_user.best_score(@level)
        %table
          %tr
            %td.stat-title Rotations
            %td.stat-value= current_user.best_rotation(@level)
          %tr
            %td.stat-title Locks
            %td.stat-value= "#{current_user.best_locked(@level)} / #{@level.total_lockable}"
          %tr
            %td.stat-title Coins
            %td.stat-value= current_user.best_coins(@level)
      - else
        %p.bold You have never completed this level.
    %div#level-stats
      %h4 Community Best Score
      - if @level.users_completed.length > 0
        %p.top-score= @level.best_score
        %table
          %tr
            %td.stat-title Rotations
            %td.stat-value= @level.best_rotation
          %tr
            %td.stat-title Locks
            %td.stat-value= "#{@level.best_locked} / #{@level.total_lockable}"
          %tr
            %td.stat-title Coins
            %td.stat-value= @level.best_coins
      - else
        %p.bold No one has ever completed this level.
            